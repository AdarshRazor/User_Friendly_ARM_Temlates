{
  "if": {
     "anyOf": [
    {
     "not": {
       "anyOf": [
          {
           "field": "type",
           "equals": "Microsoft.DataFactory/factories/*"
          },
         {
           "field": "type",
           "like": "Microsoft.Databricks/workspaces/*"
           },
          {
            "field": "type",
            "equals": "Microsoft.CognitiveServices/accounts/*"
          },
          {
            "field": "type",
            "equals": "Microsoft.KeyVault/vaults/*"
        },
        {
            "field": "type",
            "equals": "Microsoft.CognitiveServices/formrecognizer/*"
        },
        {
            "field": "type",
            "equals": "Microsoft.Storage/storageAccounts/*"
        },
        {
            "field": "type",
            "equals": "Microsoft.Web/sites/*"
        },
        {
            "field": "type",
            "equals": "Microsoft.Web/sites/functions/*"
        },
        {
          "field": "type",
          "equals": "Microsoft.ContainerService/managedClusters/*"
      },
      {
          "field": "type",
          "equals": "Microsoft.Authorization/roleAssignments/*"
      },
      {
          "field": "type",
          "equals": "Microsoft.CognitiveServices/*"
      },
      {
          "field": "type",
          "equals": "Microsoft.CognitiveServices/accounts/speechservices/*"
      },
                   {
           "field": "type",
           "in": ["Microsoft.Databricks/workspaces", "Microsoft.DataFactory/factories", "Microsoft.CognitiveServices/accounts","Microsoft.Storage/storageAccounts", "Microsoft.CognitiveServices/formrecognizer", "Microsoft.KeyVault/vaults","Microsoft.Web/sites","Microsoft.Web/sites/functions","Microsoft.ContainerService/managedClusters","Microsoft.Authorization/roleAssignments","Microsoft.CognitiveServices", "Microsoft.CognitiveServices/accounts/speechservices"]
           }
               ]
     }
    },
           {
     "allOf": [
       {
       "source": "action",
       "equals": "Microsoft.Synapse/workspaces/write"
       },
       {
       "field": "type",
       "equals": "Microsoft.Synapse/workspaces"
       },
       {
       "source": "action",
       "equals": "Microsoft.Purview/accounts/write"
       },
       {
       "field": "type",
       "equals": "Microsoft.Purview/accounts"
       }
     ]
     }
   ]
 },
 "then": {
   "effect": "deny"
 }
}
